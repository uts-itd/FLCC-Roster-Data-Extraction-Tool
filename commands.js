/*! For license information please see commands.js.LICENSE.txt */
!function(){var t={26689:function(t){function e(t){var e=t.indexOf("(");return e>-1?t.substring(0,e-1).trim():t.trim()}function n(t){var e=t.match(/((from|start|until|finish|lunch)\s*)?\d{1,2}.\d{1,2}(\s?-\s?)?((until|finish)?\s*\d{1,2}.\d{1,2})?/g);return null===e?e:e[0]}function r(t){var e=t.split(".");return e[0]/1+e[1]/60}function a(t){var e=t.match(/\blunch\s+(\d{1,2}[.:]\d{2})\b/i);return e?e[0]:null}function o(t,e){var n=e.values[0][t].match(/\d{1,2}-\d{1,2}/);try{return n[0].split("-").map((function(t){return Number(t)}))}catch(t){return null}}t.exports={extractName:e,extractTimeOverride:n,convertTime:r,excelDateToJSDate:function(t){var e=Math.floor(t-25569);return new Date(86400*e*1e3)},cleanTimeStringOverride:function(t){var e=t.replace("until","til");return(e=e.replace("till","til")).replace(":",".")},extractLunchTime:a,getTimeRange:o,extractRosterData:function(t,i){var u=t.rows.items,c=[],s=new Date(Date.parse(i.values[0][0])).toLocaleDateString("en-AU");return u.forEach((function(u){for(var f=u.values[0][0],l=1;l<=t.columns.count-1;l++){var m=u.values[0][l];if(""!==m){var v=e(m),h=o(l,i),d=n(m),p=a(m),y=/\d{1,2}.\d{1,2}/g;if(p){var b=r(p.match(y)[0]),w=b+.5>=13?b+.5-12:b+.5,g=w>b?w-b:w+12-b,x=h[0]<b?Number(h[0]):w,R=h[1]==w?b:Number(h[1]),O=R>x?R-x:R+12-x;b<x?(c.push([v,"Lunch",s,b,w,g,m]),c.push([v,f,s,x,R,O,m])):(c.push([v,f,s,x,R,O,m]),c.push([v,"Lunch",s,b,w,g,m]))}else{var T=Number(h[0]),k=Number(h[1]);d&&((d.startsWith("start")||d.startsWith("from"))&&(T=r(d.match(y)[0])),(d.startsWith("finish")||d.startsWith("until"))&&(k=r(d.match(y)[0])));var D=k>T?k-T:k+12-T;c.push([v,f,s,T,k,D,m])}}}})),c}}}},e={};function n(){var t,e,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.toStringTag||"@@toStringTag";function u(n,a,o,i){var u=a&&a.prototype instanceof s?a:s,f=Object.create(u.prototype);return r(f,"_invoke",function(n,r,a){var o,i,u,s=0,f=a||[],l=!1,m={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,n){return o=e,i=0,u=t,m.n=n,c}};function v(n,r){for(i=n,u=r,e=0;!l&&s&&!a&&e<f.length;e++){var a,o=f[e],v=m.p,h=o[2];n>3?(a=h===r)&&(u=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=t):o[0]<=v&&((a=n<2&&v<o[1])?(i=0,m.v=r,m.n=o[1]):v<h&&(a=n<3||o[0]>r||r>h)&&(o[4]=n,o[5]=r,m.n=h,i=0))}if(a||n>1)return c;throw l=!0,r}return function(a,f,h){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&v(f,h),i=f,u=h;(e=i<2?t:u)||!l;){o||(i?i<3?(i>1&&(m.n=-1),v(i,u)):m.n=u:m.v=u);try{if(s=2,o){if(i||(a="next"),e=o[a]){if(!(e=e.call(o,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,i<2&&(i=0)}else 1===i&&(e=o.return)&&e.call(o),i<2&&(u=TypeError("The iterator does not provide a '"+a+"' method"),i=1);o=t}else if((e=(l=m.n<0)?u:n.call(r,m))!==c)break}catch(e){o=t,i=1,u=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),f}var c={};function s(){}function f(){}function l(){}e=Object.getPrototypeOf;var m=[][o]?e(e([][o]())):(r(e={},o,(function(){return this})),e),v=l.prototype=s.prototype=Object.create(m);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,r(t,i,"GeneratorFunction")),t.prototype=Object.create(v),t}return f.prototype=l,r(v,"constructor",l),r(l,"constructor",f),f.displayName="GeneratorFunction",r(l,i,"GeneratorFunction"),r(v),r(v,i,"Generator"),r(v,o,(function(){return this})),r(v,"toString",(function(){return"[object Generator]"})),(n=function(){return{w:u,m:h}})()}function r(t,e,n,a){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}r=function(t,e,n,a){if(e)o?o(t,e,{value:n,enumerable:!a,configurable:!a,writable:!a}):t[e]=n;else{var i=function(e,n){r(t,e,(function(t){return this._invoke(e,n,t)}))};i("next",0),i("throw",1),i("return",2)}},r(t,e,n,a)}function a(t,e,n,r,a,o,i){try{var u=t[o](i),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,a)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function u(t){a(i,r,o,u,c,"next",t)}function c(t){a(i,r,o,u,c,"throw",t)}u(void 0)}))}}var i=function n(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}(26689);function u(){return u=o(n().m((function t(e){return n().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,Excel.run(function(){var t=o(n().m((function t(r){var a,o,u,f,l,m;return n().w((function(t){for(;;)switch(t.n){case 0:return r.workbook.names,a=r.workbook.tables,o=r.workbook.worksheets,r.workbook.load("worksheets/items/name, tables/items/rows/items/values, tables/items/name, tables/items/columns/items, names/items/arrayValues/values, names/items/name"),t.n=1,r.sync();case 1:return u=[],a.items.forEach((function(t){var e=t.getHeaderRowRange().load("values");u.push({tableName:t.name,headerRowRange:e})})),t.n=2,r.sync();case 2:f=[],a.items.forEach((function(t){var e=t.name.match(/(Monday|Tuesday|Wednesday|Thursday|Friday)\d{1}/g);e&&f.push(e[0])})),f.length>0&&(c(o).activate(),l=s(a),m=[],f.forEach((function(t){try{var e=a.items.find((function(e){return e.name===t})),n=u.find((function(e){return e.tableName===t})),r=i.extractRosterData(e,n.headerRowRange);m=m.concat(r)}catch(e){console.log("".concat(t," not found"))}})),l.rows.add(null,m),l.getRange().format.autofitColumns()),e.completed();case 3:return t.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:return t.a(2)}}),t)}))),u.apply(this,arguments)}function c(t){var e="Roster Data",n=t.items.find((function(t){return t.name===e}));return void 0===n&&(n=t.add(e)),n}function s(t){var e="rosterData",n=t.items.find((function(t){return t.name===e}));return void 0===n?((n=t.add("'Roster Data'!A1:G1",!0)).name=e,n.getHeaderRowRange().values=[["Name","Allocation","Date","Start","End","Time","Value"]]):n.rows.deleteRows(n.rows.items),n}Office.onReady((function(){})),Office.actions.associate("extractData",(function(t){return u.apply(this,arguments)}))}();
//# sourceMappingURL=commands.js.map